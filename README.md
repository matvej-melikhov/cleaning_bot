# Бот для напоминания об уборке

Телеграм бот для напоминания об уборке в комнате и блоке. Отслеживает расписание уборок, отправляет напоминания и ведет статистику.

## Возможности

- Разные расписания для уборки комнаты (каждые 14 дней) и блока (каждый месяц в одно число)
- Автоматические напоминания:
  - За день до уборки
  - В день уборки (в 12:00, 15:00, 18:00, 21:00)
  - После просрочки (в те же часы)
- Отметка о выполнении уборки через команды
- Просмотр ближайших дежурств
- Статистика выполнения уборок (вовремя/с опозданием)

## Установка и запуск

### Локальный запуск

1. Создайте файл `.env` на основе `.env.example`:
```
BOT_TOKEN=your_bot_token_here  # Получить у @BotFather
CHAT_ID=your_chat_id_here      # Узнать командой /my_id
```

2. Настройте `config.json`:
```json
{
    "room": {
        "users": [
            "@username1",
            "@username2"
        ],
        "start_date": "2025-09-21"
    },
    "block": {
        "users": [
            "@username1",
            "@username2"
        ],
        "start_date": "2025-09-21"
    }
}
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

4. Запустите бота:
```bash
python init_schedule.py  # Инициализация расписания
python main.py          # Запуск бота
```

### Запуск в Docker

1. Установите Docker и docker-compose

2. Подготовьте файлы `.env` и `config.json` как описано выше

3. Соберите и запустите контейнер:
```bash
docker-compose up --build -d
```

### Развертывание на хостинге

1. Подготовьте файлы локально (`.env` и `config.json`)

2. Скопируйте файлы на хостинг:
```bash
# Создайте папку на хостинге
ssh user@host "mkdir -p ~/cleaning_bot"

# Скопируйте файлы (выполните локально)
scp -r ./* user@host:~/cleaning_bot/
```

3. Запустите на хостинге:
```bash
cd ~/cleaning_bot
docker-compose up -d
```

## Команды бота

- `/schedule` - показать ближайшие 3 дежурства
- `/done_room` - отметить уборку в комнате как выполненную
- `/done_block` - отметить уборку в блоке как выполненную
- `/stats` - показать статистику уборок
- `/help` - показать список команд
- `/my_id` - показать ID текущего чата

## Управление ботом в Docker

```bash
# Просмотр логов
docker-compose logs -f

# Перезапуск
docker-compose restart

# Остановка
docker-compose down

# Обновление (после изменения кода)
docker-compose build --no-cache
docker-compose up -d
```

## Структура данных

- База данных: SQLite (`cleaning.db`)
- Таблицы:
  - `room_queue` - очередь уборки комнаты
  - `block_queue` - очередь уборки блока
  - `room_schedule` - расписание уборки комнаты
  - `block_schedule` - расписание уборки блока

## Обновление бота

1. Внесите изменения в код
2. Если бот запущен локально:
   ```bash
   # Остановите бота (Ctrl+C)
   python init_schedule.py
   python main.py
   ```
3. Если бот в Docker:
   ```bash
   docker-compose build --no-cache
   docker-compose up -d
   ```